.\" Automatically generated by Pod::Man 4.11 (Pod::Simple 3.35)
.\"
.\" Standard preamble:
.\" ========================================================================
.de Sp \" Vertical space (when we can't use .PP)
.if t .sp .5v
.if n .sp
..
.de Vb \" Begin verbatim text
.ft CW
.nf
.ne \\$1
..
.de Ve \" End verbatim text
.ft R
.fi
..
.\" Set up some character translations and predefined strings.  \*(-- will
.\" give an unbreakable dash, \*(PI will give pi, \*(L" will give a left
.\" double quote, and \*(R" will give a right double quote.  \*(C+ will
.\" give a nicer C++.  Capital omega is used to do unbreakable dashes and
.\" therefore won't be available.  \*(C` and \*(C' expand to `' in nroff,
.\" nothing in troff, for use with C<>.
.tr \(*W-
.ds C+ C\v'-.1v'\h'-1p'\s-2+\h'-1p'+\s0\v'.1v'\h'-1p'
.ie n \{\
.    ds -- \(*W-
.    ds PI pi
.    if (\n(.H=4u)&(1m=24u) .ds -- \(*W\h'-12u'\(*W\h'-12u'-\" diablo 10 pitch
.    if (\n(.H=4u)&(1m=20u) .ds -- \(*W\h'-12u'\(*W\h'-8u'-\"  diablo 12 pitch
.    ds L" ""
.    ds R" ""
.    ds C` ""
.    ds C' ""
'br\}
.el\{\
.    ds -- \|\(em\|
.    ds PI \(*p
.    ds L" ``
.    ds R" ''
.    ds C`
.    ds C'
'br\}
.\"
.\" Escape single quotes in literal strings from groff's Unicode transform.
.ie \n(.g .ds Aq \(aq
.el       .ds Aq '
.\"
.\" If the F register is >0, we'll generate index entries on stderr for
.\" titles (.TH), headers (.SH), subsections (.SS), items (.Ip), and index
.\" entries marked with X<> in POD.  Of course, you'll have to process the
.\" output yourself in some meaningful fashion.
.\"
.\" Avoid warning from groff about undefined register 'F'.
.de IX
..
.nr rF 0
.if \n(.g .if rF .nr rF 1
.if (\n(rF:(\n(.g==0)) \{\
.    if \nF \{\
.        de IX
.        tm Index:\\$1\t\\n%\t"\\$2"
..
.        if !\nF==2 \{\
.            nr % 0
.            nr F 2
.        \}
.    \}
.\}
.rr rF
.\" ========================================================================
.\"
.IX Title "Net::LDAP::Util 3"
.TH Net::LDAP::Util 3 "2019-04-16" "perl v5.30.2" "User Contributed Perl Documentation"
.\" For nroff, turn off justification.  Always turn off hyphenation; it makes
.\" way too many mistakes in technical documents.
.if n .ad l
.nh
.SH "NAME"
Net::LDAP::Util \- Utility functions
.SH "SYNOPSIS"
.IX Header "SYNOPSIS"
.Vb 4
\&  use Net::LDAP::Util qw(ldap_error_text
\&                         ldap_error_name
\&                         ldap_error_desc
\&                        );
\&
\&  $mesg = $ldap\->search( .... );
\&
\&  die "Error ",ldap_error_name($mesg)  if $mesg\->code;
.Ve
.SH "DESCRIPTION"
.IX Header "DESCRIPTION"
\&\fBNet::LDAP::Util\fR is a collection of utility functions for use with
the Net::LDAP modules.
.SH "FUNCTIONS"
.IX Header "FUNCTIONS"
.IP "ldap_error_name ( \s-1ERR\s0 )" 4
.IX Item "ldap_error_name ( ERR )"
Returns the name corresponding with \s-1ERR. ERR\s0 can either be an \s-1LDAP\s0
error number, or a \f(CW\*(C`Net::LDAP::Message\*(C'\fR object containing an error
code. If the error is not known the a string in the form \f(CW"LDAP error
code %d(0x%02X)"\fR is returned.
.IP "ldap_error_text ( \s-1ERR\s0 )" 4
.IX Item "ldap_error_text ( ERR )"
Returns the text from the \s-1POD\s0 description for the given error. \s-1ERR\s0 can
either be an \s-1LDAP\s0 error code, or a \f(CW\*(C`Net::LDAP::Message\*(C'\fR object
containing an \s-1LDAP\s0 error code. If the error code given is unknown then
\&\f(CW\*(C`undef\*(C'\fR is returned.
.IP "ldap_error_desc ( \s-1ERR\s0 )" 4
.IX Item "ldap_error_desc ( ERR )"
Returns a short text description of the error. \s-1ERR\s0 can either be an
\&\s-1LDAP\s0 error code or a \f(CW\*(C`Net::LDAP::Message\*(C'\fR object containing an \s-1LDAP\s0
error code.
.IP "canonical_dn ( \s-1DN\s0 [ , \s-1OPTIONS\s0 ] )" 4
.IX Item "canonical_dn ( DN [ , OPTIONS ] )"
Returns the given \fB\s-1DN\s0\fR in a canonical form. Returns undef if \fB\s-1DN\s0\fR is
not a valid Distinguished Name. (Note: The empty string "" is a valid \s-1DN.\s0)
\&\fB\s-1DN\s0\fR can either be a string or reference to an array of hashes as returned by
ldap_explode_dn, which is useful when constructing a \s-1DN.\s0
.Sp
It performs the following operations on the given \fB\s-1DN\s0\fR:
.RS 4
.IP "\(bu" 4
Removes the leading '\s-1OID.\s0' characters if the type is an \s-1OID\s0 instead
of a name.
.IP "\(bu" 4
Escapes all \s-1RFC 4514\s0 special characters (\*(L",\*(R", \*(L"+\*(R", ""\*(L", \*(R"\e\*(L", \*(R"<\*(L",
\&\*(R">\*(L", \*(R";\*(L", \*(R"#\*(L", \*(R"=\*(L", \*(R" \*(L"), slashes (\*(R"/"), and any other character
where the \s-1ASCII\s0 code is < 32 as \ehexpair.
.IP "\(bu" 4
Converts all leading and trailing spaces in values to be \e20.
.IP "\(bu" 4
If an \s-1RDN\s0 contains multiple parts, the parts are re-ordered so that
the attribute type names are in alphabetical order.
.RE
.RS 4
.Sp
\&\fB\s-1OPTIONS\s0\fR is a list of name/value pairs, valid options are:
.IP "casefold" 4
.IX Item "casefold"
Controls case folding of attribute type names. Attribute values are not
affected by this option. The default is to uppercase. Valid values are:
.RS 4
.IP "lower" 4
.IX Item "lower"
Lowercase attribute type names.
.IP "upper" 4
.IX Item "upper"
Uppercase attribute type names. This is the default.
.IP "none" 4
.IX Item "none"
Do not change attribute type names.
.RE
.RS 4
.RE
.IP "mbcescape" 4
.IX Item "mbcescape"
If \s-1TRUE,\s0 characters that are encoded as a multi-octet \s-1UTF\-8\s0 sequence
will be escaped as \e(hexpair){2,*}.
.IP "reverse" 4
.IX Item "reverse"
If \s-1TRUE,\s0 the \s-1RDN\s0 sequence is reversed.
.IP "separator" 4
.IX Item "separator"
Separator to use between RDNs. Defaults to comma (',').
.RE
.RS 4
.RE
.IP "ldap_explode_dn ( \s-1DN\s0 [ , \s-1OPTIONS\s0 ] )" 4
.IX Item "ldap_explode_dn ( DN [ , OPTIONS ] )"
Explodes the given \fB\s-1DN\s0\fR into an array of hashes and returns a reference to this
array. Returns undef if \fB\s-1DN\s0\fR is not a valid Distinguished Name.
.Sp
A Distinguished Name is a sequence of Relative Distinguished Names (RDNs), which
themselves are sets of Attributes. For each \s-1RDN\s0 a hash is constructed with the
attribute type names as keys and the attribute values as corresponding values.
These hashes are then stored in an array in the order in which they appear
in the \s-1DN.\s0
.Sp
For example, the \s-1DN\s0 'OU=Sales+CN=J. Smith,DC=example,DC=net' is exploded to:
 [
   {
     '\s-1OU\s0' => 'Sales',
     '\s-1CN\s0' => 'J. Smith'
   },
   {
     '\s-1DC\s0' => 'example'
   },
   {
     '\s-1DC\s0' => 'net'
   }
 ]
.Sp
(\s-1RFC4514\s0 string) DNs might also contain values, which are the bytes of the
\&\s-1BER\s0 encoding of the X.500 AttributeValue rather than some \s-1LDAP\s0 string syntax.
These values are hex-encoded and prefixed with a #. To distinguish such \s-1BER\s0
values, ldap_explode_dn uses references to the actual values,
e.g. '1.3.6.1.4.1.1466.0=#04024869,DC=example,DC=com' is exploded to:
 [
   {
     '1.3.6.1.4.1.1466.0' => \*(L"\e004\e002Hi\*(R"
   },
   {
     '\s-1DC\s0' => 'example'
   },
   {
     '\s-1DC\s0' => 'com'
   }
 ];
.Sp
It also performs the following operations on the given \s-1DN:\s0
.RS 4
.IP "\(bu" 4
Unescape \*(L"\e\*(R" followed by \*(L",\*(R", \*(L"+\*(R", ""\*(L", \*(R"\e\*(L", \*(R"<\*(L", \*(R">\*(L", \*(R";\*(L",
\&\*(R"#\*(L", \*(R"=\*(L", \*(R" \*(L", or a hexpair and strings beginning with \*(R"#".
.IP "\(bu" 4
Removes the leading '\s-1OID.\s0' characters if the type is an \s-1OID\s0 instead
of a name.
.RE
.RS 4
.Sp
\&\fB\s-1OPTIONS\s0\fR is a list of name/value pairs, valid options are:
.IP "casefold" 4
.IX Item "casefold"
Controls case folding of attribute types names. Attribute values are not
affected by this option. The default is to uppercase. Valid values are:
.RS 4
.IP "lower" 4
.IX Item "lower"
Lowercase attribute types names.
.IP "upper" 4
.IX Item "upper"
Uppercase attribute type names. This is the default.
.IP "none" 4
.IX Item "none"
Do not change attribute type names.
.RE
.RS 4
.RE
.IP "reverse" 4
.IX Item "reverse"
If \s-1TRUE,\s0 the \s-1RDN\s0 sequence is reversed.
.RE
.RS 4
.RE
.IP "escape_filter_value ( \s-1VALUES\s0 )" 4
.IX Item "escape_filter_value ( VALUES )"
Escapes the given \fB\s-1VALUES\s0\fR according to \s-1RFC 4515\s0 so that they
can be safely used in \s-1LDAP\s0 filters.
.Sp
Any control characters with an \s-1ASCII\s0 code < 32 as well as the
characters with special meaning in \s-1LDAP\s0 filters \*(L"*\*(R", \*(L"(\*(R", \*(L")\*(R",
and \*(L"\e\*(R" the backslash are converted into the representation
of a backslash followed by two hex digits representing the
hexadecimal value of the character.
.Sp
Returns the converted list in list mode and the first element
in scalar mode.
.IP "unescape_filter_value ( \s-1VALUES\s0 )" 4
.IX Item "unescape_filter_value ( VALUES )"
Undoes the conversion done by \fB\fBescape_filter_value()\fB\fR.
.Sp
Converts any sequences of a backslash followed by two hex digits
into the corresponding character.
.Sp
Returns the converted list in list mode and the first element
in scalar mode.
.IP "escape_dn_value ( \s-1VALUES\s0 )" 4
.IX Item "escape_dn_value ( VALUES )"
Escapes the given \fB\s-1VALUES\s0\fR according to \s-1RFC 4514\s0 so that they
can be safely used in \s-1LDAP\s0 DNs.
.Sp
The characters \*(L",\*(R", \*(L"+\*(R", ""\*(L", \*(R"\e\*(L", \*(R"<\*(L", \*(R">\*(L", \*(R";\*(L", \*(R"#\*(L", \*(R"=" with
a special meaning in section 2.4 of \s-1RFC 4514\s0 are preceded by a backslash.
Control characters with an \s-1ASCII\s0 code < 32 are represented
as \ehexpair.
Finally all leading and trailing spaces are converted to
sequences of \e20.
.Sp
Returns the converted list in list mode and the first element
in scalar mode.
.IP "unescape_dn_value ( \s-1VALUES\s0 )" 4
.IX Item "unescape_dn_value ( VALUES )"
Undoes the conversion done by \fB\fBescape_dn_value()\fB\fR.
.Sp
Any escape sequence starting with a backslash \- hexpair or
special character \- will be transformed back to the
corresponding character.
.Sp
Returns the converted list in list mode and the first element
in scalar mode.
.IP "ldap_url_parse ( LDAP-URL [, \s-1OPTIONS\s0 ] )" 4
.IX Item "ldap_url_parse ( LDAP-URL [, OPTIONS ] )"
Parse an \fBLDAP-URL\fR conforming to \s-1RFC 4516\s0 into a hash containing its elements.
.Sp
For easy cooperation with \s-1LDAP\s0 queries, the hash keys for the elements
used in \s-1LDAP\s0 search operations are named after the parameters to
\&\*(L"search\*(R" in Net::LDAP.
.Sp
In extension to \s-1RFC 4516,\s0 the socket path for URLs with the scheme \f(CW\*(C`ldapi\*(C'\fR
will be stored in the hash key named \f(CW\*(C`path\*(C'\fR.
.Sp
If any element is omitted, the result depends on the setting of the option
\&\f(CW\*(C`defaults\*(C'\fR.
.Sp
\&\fB\s-1OPTIONS\s0\fR is a list of key/value pairs with the following keys recognized:
.RS 4
.IP "defaults" 4
.IX Item "defaults"
A Boolean option that determines whether default values according to \s-1RFC 4516\s0
shall be returned for missing \s-1URL\s0 elements.
.Sp
If set to \s-1TRUE,\s0 default values are returned, with \f(CW\*(C`ldap_url_parse\*(C'\fR
using the following defaults in extension to \s-1RFC 4516.\s0
.RS 4
.IP "\(bu" 4
The default port for \f(CW\*(C`ldaps\*(C'\fR URLs is \f(CW636\fR.
.IP "\(bu" 4
The default path for \f(CW\*(C`ldapi\*(C'\fR URLs is the contents of the environment variable
\&\f(CW\*(C`LDAPI_SOCK\*(C'\fR. If that is not defined or empty, then \f(CW\*(C`/var/run/ldapi\*(C'\fR is used.
.Sp
This is consistent with the behaviour of \*(L"new\*(R" in Net::LDAP.
.IP "\(bu" 4
The default \f(CW\*(C`host\*(C'\fR name for \f(CW\*(C`ldap\*(C'\fR and \f(CW\*(C`ldaps\*(C'\fR URLs is \f(CW\*(C`localhost\*(C'\fR.
.RE
.RS 4
.Sp
When set to \s-1FALSE,\s0 no default values are used.
.Sp
This leaves all keys in the resulting hash undefined where the corresponding
\&\s-1URL\s0 element is empty.
.Sp
To distinguish between an empty base \s-1DN\s0 and an undefined base \s-1DN,\s0
\&\f(CW\*(C`ldap_url_parse\*(C'\fR uses the slash between the host:port resp. path
part of the \s-1URL\s0 and the base \s-1DN\s0 part of the \s-1URL.\s0
With the slash present, the hash key \f(CW\*(C`base\*(C'\fR is set to the empty string,
without it, it is left undefined.
.Sp
Leaving away the \f(CW\*(C`defaults\*(C'\fR option entirely is equivalent to setting it to \s-1TRUE.\s0
.RE
.RE
.RS 4
.Sp
Returns the hash in list mode, or the reference to the hash in scalar mode.
.RE
.IP "generalizedTime_to_time ( \s-1GENERALIZEDTIME\s0 )" 4
.IX Item "generalizedTime_to_time ( GENERALIZEDTIME )"
Convert the generalizedTime string \fB\s-1GENERALIZEDTIME\s0\fR, which is expected
to match the template \f(CW\*(C`YYYYmmddHH[MM[SS]][(./,)d...](Z|(+/\-)HH[MM])\*(C'\fR
to a floating point number compatible with \s-1UNIX\s0 time
(i.e. the integral part of the number is a \s-1UNIX\s0 time).
.Sp
Returns an extended \s-1UNIX\s0 time or \f(CW\*(C`undef\*(C'\fR on error.
.Sp
Times in years smaller than 1000 will lead to \f(CW\*(C`undef\*(C'\fR being returned.
This restriction is a direct effect of the year value interpretation rules
in Time::Local.
.Sp
\&\fBNote:\fR this function depends on Perl's implementation of time and Time::Local.
See \*(L"Limits of time_t\*(R" in Time::Local, \*(L"Negative Epoch Values\*(R" in Time::Local, and
\&\*(L"gmtime\*(R" in perlport for restrictions in older versions of Perl.
.IP "time_to_generalizedTime ( \s-1TIME\s0 [, \s-1OPTIONS\s0 ] )" 4
.IX Item "time_to_generalizedTime ( TIME [, OPTIONS ] )"
Convert the \s-1UNIX\s0 time \fB\s-1TIME\s0\fR to a generalizedTime string.
.Sp
In extension to \s-1UNIX\s0 times, \fB\s-1TIME\s0\fR may be a floating point number,
the decimal part will be used for the resulting generalizedTime.
.Sp
\&\fB\s-1OPTIONS\s0\fR is a list of key/value pairs. The following keys are recognized:
.RS 4
.IP "\s-1AD\s0" 4
.IX Item "AD"
Take care of an ActiveDirectory peculiarity to always require decimals.
.RE
.RS 4
.Sp
Returns the generalizedTime string, or \f(CW\*(C`undef\*(C'\fR on error.
.Sp
Times before \s-1BC\s0 or after year 9999 result in \f(CW\*(C`undef\*(C'\fR
as they cannot be represented in the generalizedTime format.
.Sp
\&\fBNote:\fR this function depends on Perl's implementation of gmtime.
See \*(L"Limits of time_t\*(R" in Time::Local, \*(L"Negative Epoch Values\*(R" in Time::Local, and
\&\*(L"gmtime\*(R" in perlport for restrictions in older versions of Perl.
.RE
.SH "AUTHOR"
.IX Header "AUTHOR"
Graham Barr <gbarr@pobox.com>
.SH "COPYRIGHT"
.IX Header "COPYRIGHT"
Copyright (c) 1999\-2004 Graham Barr. All rights reserved. This program is
free software; you can redistribute it and/or modify it under the same
terms as Perl itself.
.PP
ldap_explode_dn and canonical_dn also
.PP
(c) 2002 Norbert Klasen, norbert.klasen@daasi.de, All Rights Reserved.
